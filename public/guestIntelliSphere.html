<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap Link -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
      defer
    ></script>

    <!-- JQuery Link -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Gauge -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-gauge"></script>

    <!-- Font Awesome -->
    <script
      src="https://kit.fontawesome.com/4f6d96e165.js"
      crossorigin="anonymous"
    ></script>

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lora:ital,wght@0,400..700;1,400..700&display=swap"
      rel="stylesheet"
    />

    <!-- Page Name -->
    <title>Mindsphere</title>

    <!-- Linking CSS -->
    <link rel="stylesheet" href="./css/normalize.css" />
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/navbar.css" />
    <link rel="stylesheet" href="./css/guestIntelliSphere.css" />
    <link rel="stylesheet" href="./css/guestIntelliSphere-faceExpression.css" />
    <link rel="stylesheet" href="./css/footer.css" defer />

    <!-- Linking JS -->
    <script src="./js/script.js" defer></script>
    <script src="./js/navbarFooter.js" defer></script>
    <script src="./js/guestIntelliSphere.js" defer></script>
    <script src="./js/face-api.min.js" defer></script>
    <script src="./js/guestIntellisphere-faceExpression.js" defer></script>

    <!-- Add a favicon to the tab bar -->
    <link
      rel="icon"
      type="image/x-icon"
      href="./img/logo/mindsphere-logo.png"
    />
  </head>
  <body>
    <header>
      <div id="navbar-container"></div>
    </header>

    <!-- Transparent Row with Small Height at the Top -->
    <div class="row" style="height: 50px; background-color: transparent"></div>

    <!-- Main Content Container -->
    <div class="container text-start">
      <div class="row justify-content-center">
        <div class="col-12">
          <!-- Load customAlert.html dynamically -->
          <div id="customAlertContainer"></div>

          <div class="container text-start">
            <h1 class="mt-3 text-center">IntelliSphere</h1>
            <p class="mb-3 text-center">Your Personalised AI Powered Coach</p>

            <div class="video-container">
              <video id="video" width="720" height="560" autoplay muted></video>
            </div>

            <!-- Audio Playback Section -->
            <div class="my-4" id="audioContainer" style="height: 80px">
              <div
                class="row d-flex justify-content-center align-items-center"
                style="padding: 10px"
              >
                <div
                  class="col-4"
                  style="
                    position: relative;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                  "
                >
                  <div
                    id="recordingIndicator"
                    class="text-success"
                    style="
                      display: none;
                      position: absolute;
                      top: -15px;
                      left: 0;
                      width: 100%;
                      text-align: center;
                    "
                  >
                    Recording...
                  </div>
                  <audio id="audioPlayback" controls style="width: 100%">
                    <source id="audioSource" src="" type="audio/wav" />
                    Your browser does not support the audio tag.
                  </audio>
                </div>
                <div class="col-1 d-flex justify-content-center">
                  <button
                    id="confirmButton"
                    class="btn btn-success p-2"
                    disabled
                    style="width: 100%; border-radius: 100px"
                  >
                    Confirm
                  </button>
                </div>
              </div>
            </div>

            <!-- Recording Controls -->
            <div class="my-4 text-center">
              <button
                id="startRecording"
                class="btn btn-primary me-2 p-2 enabled"
              >
                <i class="fas fa-microphone" style="padding-right: 5px"></i>
                Start Recording
              </button>
              <button
                id="stopRecording"
                class="btn btn-danger p-2"
                style="border-radius: 100px"
                disabled
              >
                <i class="fas fa-stop" style="padding-right: 5px"></i> Stop
                Recording
              </button>
            </div>

            <!-- Evaluation Data Display -->
            <div class="row justify-content-center">
              <div class="col-md-6">
                <!-- Dynamic Evaluation Results Card -->
                <div id="evaluationResultsContainer"></div>
              </div>
            </div>
          </div>
          <!-- END OF PAGE'S CONTENT -->
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bd-footer py-4 py-md-5 mt-5">
      <div
        id="footer"
        class="container py-4 py-md-5 px-4 px-md-3 text-body-secondary"
      ></div>
    </footer>

    <!-- Custom JS to Load customAlert.html -->
    <script>
      $("#customAlertContainer").load("./customAlert.html");

      window.showCustomAlert = function (message, redirectUrl) {
        var $alert = $("#customAlert");
        $alert.text(message);
        $alert.fadeIn();

        var displayDuration = redirectUrl ? 1000 : 5000;
        setTimeout(function () {
          $alert.fadeOut();

          if (redirectUrl) {
            setTimeout(function () {
              window.location.href = redirectUrl;
            }, 1000);
          }
        }, displayDuration);
      };
    </script>
  </body>
</html>
